\section{Approssimazioni della funzione Gamma}
\begin{lemma}\label{ga:LimiteIntegrali}
	Siano $f_n$, con $n\in\mathbb{N}$, e $g$ funzioni definite in $(0,\infty)$ e Riemann-integrabili su $[a,b]$ per ogni
	$0<a<b<\infty$. Se valgono le seguenti proprietà:
	\begin{itemize}
		\item $|f_n|\le g$ per ogni $n\in\mathbb{N}$;
		\item $f_n\to f$ uniformemente in ogni intervallo chiuso di $(0,\infty)$;
		\item $\int_0^\infty{g(x)dx}<\infty$.
	\end{itemize}
	Allora vale che:
	\begin{equation*}
		\lim_{n\to\infty}\int_0^\infty f_n(x)dx=\int_0^\infty f(x)dx
	\end{equation*}
\end{lemma}

\begin{proof}
	Dimostro innanzitutto che per ogni $0<a<b<\infty$, ho che $f$ è integrabile su $[a,b]$ e in particolare vale:
	\begin{equation*}
		\int_a^b{f(x)dx}=\lim_{n->\infty}\int_a^b{f_n(x)dx}
	\end{equation*}
	Sia $\sigma_m$ la suddivisione equispaziata dell'intervallo $[a,b]$ di nodi $x_i=a+\frac{i}{m}(b-a)$,
	allora $f$ è Riemann-integrabile su $[a,b]$ se per ogni $\varepsilon>0$ esiste $M$ tale che se $m\ge M$
	allora $|S(f,\sigma_m)-s(f,\sigma_m)|<\varepsilon$.
	Per la disuguaglianza triangolare vale però che:
	\begin{equation*}
		|S(f,\sigma_m)-s(f,\sigma_m)|\le  
		|S(f,\sigma_m)-S(f_n,\sigma_m)|+ |s(f_n,\sigma_m)-s(f,\sigma_m)|+ |S(f_n,\sigma_m)-s(f_n,\sigma_m)|
	\end{equation*}
	Dato che $f_n\to f$ uniformemente su $[a,b]$, allora per ogni $\mu>0$ esiste $N$ tale che per ogni
	$n\ge N$ e per ogni $x\in[a,b]$ vale $|f(x)-f_n(x)|<\mu$, quindi vale facilmente che per ogni $m\ge M$:
	\begin{equation} \label{ViciniInIntervallo}
	\begin{split}
		|S(f,\sigma_m)-S(f_n,\sigma_m)| & <\mu(b-a) \\
		|s(f,\sigma_m)-s(f_n,\sigma_m)| & <\mu(b-a)
	\end{split}
	\end{equation} 
	E dato che $f_n$ è Riemann-integrabile
	su $[a,b]$ per ogni $n$, allora per ogni $\mu>0$ esiste $M$ tale che per ogni $m\ge M$ vale:
	\begin{equation}
		|S(f_n,\sigma_m)-s(f_n,\sigma_m)|<\mu
	\end{equation}
	Ma allora per ogni $\mu>0$ esistono $N$ e $M$ tali che per ogni $n\ge N$ e $m\ge M$ vale:
	\begin{gather*}
		|S(f,\sigma_m)-S(f_n,\sigma_m)|+ |s(f_n,\sigma_m)-s(f,\sigma_m)|+ |S(f_n,\sigma_m)-s(f_n,\sigma_m)|<\mu(2b-2a+1) \\
		\Longrightarrow |S(f,\sigma_m)-s(f,\sigma_m)|< \mu(2b-2a+1)
	\end{gather*}
	Quindi scegliendo $\mu=\varepsilon/(2b-2a+1)$ ottengo che per ogni $m\ge M$ vale:
	\begin{equation*}
	|S(f,\sigma_m)-s(f,\sigma_m)|< \varepsilon
	\end{equation*}
	Quindi $f$ è Riemann-integrabile su $[a,b]$, e in particolare dalla \cref{ViciniInIntervallo} si ottiene facilmente
	anche che
	\begin{equation}\label{IntegraleInIntervallo}
		\int_a^b{f(x)dx}=\lim_{n->\infty}\int_a^b{f_n(x)dx}
	\end{equation}
	Da quest'ultima relazione ottengo anche che $|f|$ è Riemann-integrabile in $[a,b]$, poichè in generale se
	$h$ è una funzione Riemann-integrabile in $[a,b]$ lo è anche $|h|$.\\
	Ora, dato che $|f_n|\le g$ per ogni $n\in\mathbb{N}$, passando al limite ottengo che $|f(x)|\le g(x)$ per ogni $x\in(0,\infty)$.
	Di conseguenza, dato che per quanto già detto $|f|$ è Riemann-integrabile in $[a,b]$, $|f|$ è Riemann-integrabile
	anche in $(0,\infty)$ perchè è non negativa.\\
	Ma dato che esiste l'integrale improprio di $|f|$ su $(0,\infty)$, allora esiste anche l'integrale improprio di $f$ su 
	$(0,\infty)$, e analogamente a quanto detto prima su un intervallo, vale proprio:
	\begin{equation*}
		\int_0^\infty{f(x)dx}=\lim_{n->\infty}\int_0^\infty{f_n(x)dx}
	\end{equation*}
\end{proof}

\begin{theorem}[Formula di Stirling per la funzione Gamma]\label{StirlingGamma}
	La formula di Stirling offre un'approssimazione per $\Gamma(x+1)$:
	\begin{equation*}
		\lim_{x\to\infty}\frac{\Gamma(x+1)}{(x/e)^x\sqrt{2\pi x}}=1
	\end{equation*}
\end{theorem}
\begin{proof}
	Sostituendo $t=x(1+s\sqrt{2/x})$ nella definizione della funzione Gamma \cref{FunzioneGamma} ottengo:
	\begin{equation} \label{ga:QuasiStirling}
	\begin{split}
		\Gamma(x+1) & = \int_0^\infty{e^{-t}t^{x}dt}\\
					& = \int_{-\sqrt{\frac{x}{2}}}^\infty{ e^{-x(1+s\sqrt{2/x})} x^x\left(1+s\sqrt{\frac{2}{x}}\right)^x \sqrt{2x} ds}\\
					& = e^{-x}x^x\sqrt{2x}\int_{-\sqrt{\frac{x}{2}}}^\infty{ \left[e^{-s\sqrt{2/x}} \left(1+s\sqrt{\frac{2}{x}}\right)\right]^x ds}\\
					& = e^{-x}x^x\sqrt{2x}\int_{-\sqrt{\frac{x}{2}}}^\infty{ e^{-s\sqrt{2x}+x\ln\left(1+s\sqrt{\frac{2}{x}}\right)} ds}\\
					& = e^{-x}x^x\sqrt{2x}\int_{-\sqrt{\frac{x}{2}}}^\infty{ e^{-s^2\left(\frac{\sqrt{2x}}{s}-\frac{x}{s^2}\ln\left(1+s\sqrt{\frac{2}{x}}\right)\right)} ds}
	\end{split}
	\end{equation}
	Ora definisco per comodità $h_x(s)=\frac{\sqrt{2x}}{s}-\frac{x}{s^2}\ln\left(1+s\sqrt{\frac{2}{x}}\right)$ 
	e mi concentro su quest'ultimo integrale, in particolare esso è uguale a:
	\begin{equation*}
		\int_{-\infty}^\infty{ f_x(s) ds}
	\end{equation*}
	dove 
	\begin{equation*}
		f_x(s)=\begin{cases}
				e^{-s^2h_x(s)}, & \mbox{se } -\sqrt{x/2}<s<\infty \\
							 0, & \mbox{se } s\le -\sqrt{x/2}
	\end{cases}
	\end{equation*}
	
	Dimostro innanzitutto che $f_x(s)\to e^{-s^2}$ uniformemente su $[a,b]$ per $x\to\infty$, con 
	$-\infty<a<b<\infty$. Ciò equivale a dimostrare che $h_x(s)\to 1$ uniformemente su $[a,b]$ per $x\to\infty$.
	Sostituendo a $\ln\left(1+s\sqrt{\frac{2}{x}}\right)$ il suo sviluppo di Taylor ottengo la seguente identità:
	\begin{equation*}
	\begin{split}
		h_x(s)	& =\frac{\sqrt{2x}}{s}-\frac{x}{s^2}\ln\left(1+s\sqrt{\frac{2}{x}}\right)\\
				& =\frac{\sqrt{2x}}{s}-\frac{x}{s^2}\left(s\sqrt{\frac{2}{x}}-\frac{s^2}{x}+\bigO\left(\frac{s^3}{x\sqrt{x}}\right) \right)\\
				& =1+\bigO\left( \frac{s}{\sqrt{x}} \right)
	\end{split}
	\end{equation*}
	Quindi esistono $H,K$ tali che, se $\left\lvert\frac s{\sqrt x}\right\rvert<H$ allora vale 
	$|h_x(s)-1|<K\frac{|s|}{\sqrt{x}}$ per ogni $s\in [a,b]$.
	
	Allora in particolare, ponendo $M=\max_{s\in[a,b]}\{|s|\}$, risulta che, se $\left\lvert\frac M{\sqrt x}\right\rvert<H$,
	allora $|h_x(s)-1|<K\frac{M}{\sqrt{x}}$. Ma questo equivale a dire:
	\begin{equation*}
		h_x(s)=1+\bigO\left( \frac{1}{\sqrt{x}} \right)
	\end{equation*}
	Che implica facilmente $h_x(s)\to 1$ uniformemente su $[a,b]$ per $x\to\infty$.
	
	Ora distinguo due casi:
	\begin{itemize}
		\item	Se $s<0$ ho che $0\le f_x(s) \le e^{-s^2}$, utilizzando l'uniforme convergenza di $f_x(s)$ in ogni
				intervallo e \cref{GaussIntegral}, posso applicare \cref{ga:LimiteIntegrali} alle funzioni $f_x(s)$ 
				e ottengo:
				\begin{equation}\label{ga:PartialIntegralNeg}
					\lim_{x\to\infty} \int_{-\infty}^0{f_x(s)ds}=\int_{-\infty}^0{\left(\lim_{x\to\infty}f_x(s)\right)ds}
					=\int_{-\infty}^0{e^{-s^2}ds}=\frac{\sqrt{\pi}}{2}
				\end{equation}
		\item	Se $s>0$ ho che $0\le f_x(s) \le f_1(s)$, in quanto $h_x(s)\ge h_1(s)$. Inoltre, grazie
				alla \cref{FunzioneGamma}, vale che:
				\begin{equation*}
				\begin{split}
					\int_0^{\infty}{f_1(s)ds}	&=\int_0^\infty{e^{-\sqrt{2}s}\left(1+\sqrt{2}s \right)ds}\\
												&=\frac{e}{\sqrt{2}}\int_0^\infty{e^{-t}t dt}\\
												&=\frac{e}{\sqrt{2}}\Gamma(2)<\infty
				\end{split}
				\end{equation*}
				Quindi, utilizzando la convergenza uniforme di $f_x(s)$ a $e^{-s^2}$ in ogni intervallo
				$[a,b]$, posso nuovamente applicare \cref{ga:LimiteIntegrali}, da cui ottengo:
				\begin{equation}\label{ga:PartialIntegralPos}
					\lim_{x\to\infty} \int_0^\infty{f_x(s)ds}=\int_0^\infty{\left(\lim_{x\to\infty}f_x(s)\right)ds}
					=\int_0^\infty{e^{-s^2}ds}=\frac{\sqrt{\pi}}{2}
				\end{equation}
	\end{itemize}
	
	Infine, unendo \cref{ga:PartialIntegralNeg} e \cref{ga:PartialIntegralPos}, ottengo:
	\begin{equation*}
		\lim_{x\to\infty}\int_{-\infty}^\infty{ f_x(s) ds}=\sqrt{\pi}
	\end{equation*}
	da cui passando al limite nella \cref{ga:QuasiStirling} ottengo la tesi.
\end{proof}

\begin{lemma}\label{ga:WallisProduct}
	Vale la seguente identità:
	\begin{equation*}
		\frac{\pi}{2}=\prod_{n=1}^\infty\frac{(2n)^2}{(2n-1)(2n+1)}
	\end{equation*}
\end{lemma}


\begin{theorem}[Approssimazione di Stirling per i numeri naturali]\label{ga:ApproxStirlingNaturali}
	Riportiamo un'altra dimostrazione dell'approssimazione di Stirling sui numeri naturali (che è una caso
	particolare di \cref{StirlingGamma})
	\begin{equation*}
		\lim_{n\to\infty}{\frac{n!}{(n/e)^n\sqrt{2\pi n}}}=1
	\end{equation*}
\end{theorem}
\begin{proof}
	Dimostriamo innanzitutto che esiste finito il seguente limite:
	\begin{equation}\label{ga:EsisteLimite}
		\lim_{n\to\infty}{\frac{n!}{(n/e)^n\sqrt{n}}}
	\end{equation}
	cioè, passando al logaritmo, che esiste il limite:
	\begin{equation}\label{ga:EsisteLimiteLogaritmo}
		\lim_{n\to\infty}{\sum_{k=1}^{n}\ln k-n\ln n+n-\frac{1}{2}\ln n}
	\end{equation}
	
	Vale la seguente identità:
	\begin{equation*}
		\sum_{k=1}^{n}\ln k=n\ln n-\sum_{k=1}^{n-1}{k\left(\ln(k+1)-\ln k \right)}=n\ln n-\sum_{k=1}^{n-1}{k\ln\left(1+\frac{1}{k}\right)}
	\end{equation*}
	da cui, sostituendo il logaritmo con il suo sviluppo di Taylor, ottengo:
	\begin{equation*}
	\begin{split}
		\sum_{k=1}^{n}\ln k	& =n\ln n-\sum_{k=1}^{n-1}{k\left(\frac{1}{k}-\frac{1}{2k^2}+\bigO\left(\frac{1}{k^3}\right) \right)}\\
							& =n\ln n-\sum_{k=1}^{n-1}\left(1-\frac{1}{2k}+\bigO\left(\frac{1}{k^2}\right)  \right)\\
							& =n\ln n-n+1+\frac{1}{2}\sum_{k=1}^{n-1}\frac{1}{k}+\sum_{k=1}^{n-1}\bigO\left(\frac{1}{k^2}\right)
	\end{split}
	\end{equation*}
	e utilizzando che $\sum_{k=1}^{n-1}\frac{1}{n}=\ln n+\bigO(1)$ e 
	$\sum_{k=1}^{n-1}\bigO\left(\frac{1}{k^2}\right)=\bigO(1)$, concludo:
	\begin{equation}\label{ga:QuasiStirlingNaturali}
		\sum_{k=1}^{n}\ln k=n\ln n-n+\frac{1}{2}\ln n + \bigO(1)
	\end{equation}
	Che passando al limite è proprio equivalente a \cref{ga:EsisteLimiteLogaritmo}.
	
	Dimostriamo ora che il valore del limite di \cref{ga:EsisteLimite} è proprio $\sqrt{2\pi}$.
	Grazie a \cref{ga:WallisProduct} ho che:
	\begin{equation}\label{ga:PiFactorial}
	\begin{split}
		\sqrt{\pi}	& =\sqrt{2}\prod_{n=1}^\infty\frac{2n}{\sqrt{(2n-1)(2n+1)}}\\
					& =\lim_{n\to\infty}\frac{(2n)!!}{(2n-1)!!\sqrt{n}}\\
					& =\lim_{n\to\infty}\frac{\left[(2n)!\right]^2}{(2n)!\sqrt{n}}=\lim_{n\to\infty}\frac{2^{2n}\left(n!\right)^2}{(2n)!\sqrt{n}}\\
	\end{split}
	\end{equation}
	Definisco ora:
	\begin{equation*}
		a_n=\frac{n!}{(n/e)^n\sqrt{n}}
	\end{equation*}
	Poichè $\lim_{n\to\infty}{a_n}$ esiste vale facilmente che $\lim_{n\to\infty}a_n/a_{2n}=1$, quindi:
	\begin{equation*}
		\lim_{n\to\infty}{\frac{n!}{(n/e)^n\sqrt{n}}}=\lim_{n\to\infty}{a_n}=\lim_{n\to\infty}{\frac{a_n^2}{a_{2n}}}
	\end{equation*}
	Grazie alla \cref{ga:PiFactorial}, ho però che:
	\begin{equation*}
	\begin{split}
		\lim_{n\to\infty}{\frac{a_n^2}{a_{2n}}}
		&=\lim_{n\to\infty}{\frac{\left(n!\right)^2}{(n/e)^{2n}n}\cdot \frac{(2n/e)^{2n}\sqrt{2n}}{(2n)!} }\\
		&=\lim_{n\to\infty}{\sqrt{2}\cdot\frac{2^{2n} \left(n!\right)^2}{(2n)!\sqrt{n}} }=\sqrt{2\pi}
	\end{split}
	\end{equation*}
	da cui la tesi.




	

\end{proof}



\begin{lemma}\label{ga:ApproxReali}
	Vale la seguente stima
	\begin{equation*}
		\log{\Gamma(x+1)}=\log{\Gamma(\partint{x} +1)}+\{x\}\log(x)+\bigO\left(\frac 1x\right)
	\end{equation*}
\end{lemma}
\begin{proof}
	La dimostrazione segue le linee di quella di \cref{dg:RapportoAsint}.
	
	Applico il teorema di Lagrange sulla funzione $\log\Gamma$, sfruttando \cref{dg:psiApprox}, ottenendo che esiste
	$\partint{x}\le x'\le x$ tale che:
	\begin{equation}
		\log{\Gamma(x+1)}-\log{\Gamma(\partint{x} +1)}=\{x\}\psi(y)=\{x\}\log(y)+\bigO\left(\frac 1y\right)=
		\{x\}\log(x)+\bigO\left(\frac 1x\right)
	\end{equation}
	che è la tesi.
\end{proof}

\begin{lemma}\label{ga:StupidaApprox}
	Vale la seguente approssimazione:
	\begin{equation*}
		\partint{x}(\log(\partint{x})-1)=\partint{x} \log(x)-x+\smallO(1)
	\end{equation*}
\end{lemma}
\begin{proof}
	Applicando Lagrange (e implicitamente delle approssimazioni sull'inverso):
	\begin{equation}\label{ga:NoiaApprox}
		\log{x}=\log{\partint{x}} + \frac{\{x\}}{\partint{x}} +\smallO\left(\frac 1{\partint{x}}\right)
	\end{equation}
	
	Applicando \cref{ga:NoiaApprox} vale la seguente catena di uguaglianze:
	\begin{equation*}
		\partint{x}(\log(\partint{x})-1)=\partint{x}\log{x}-\{x\}+
		\partint{x}\smallO\left(\frac 1{\partint{x}}\right)-\partint{x}=
		\partint{x}\log{x}-x+\smallO(1)
	\end{equation*}
	e questo è equivalente alla tesi.
\end{proof}



\begin{proof}[Seconda dimostrazione di Stirling]
	Applicando \cref{ga:ApproxReali,ga:StupidaApprox} e assumendo Stirling sui numeri naturali ho:
	\begin{equation*}\begin{split}
		\log{\Gamma(x+1)}&=\log\Gamma(\partint{x}+1)+\{x\}\log{x}+\bigO\left(\frac 1x\right)\\
		&=\partint{x}\left(\log{x}-1\right)+\log{\sqrt{2\pi\partint{x}}}+\{x\}\log{x}+\bigO\left(\frac 1x\right)\\
		&=\partint{x} \log(x)-x+\smallO(1)+\log{\sqrt{2\pi x}}+\{x\}\log{x}+\bigO\left(\frac 1x\right)\\
		&=x(\log{x}-1)+\log{\sqrt{2\pi x}}+\smallO(1)
	\end{split}\end{equation*}
	Che è proprio l'approssimazione di Stirling.
\end{proof}






